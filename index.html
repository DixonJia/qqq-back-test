<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>纳斯达克100 策略回测</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>纳斯达克100 双资产回测工具</h1>
    <p class="subtitle">使用真实 QQQ 历史数据进行策略模拟（1999-2026）</p>

    <section class="controls">
      <div class="control-group">
        <label>初始资金（¥）</label>
        <input id="initialCapital" type="number" value="100000" />
      </div>
      
      <div class="control-group">
        <label>纳斯达克100 配置比例（%）</label>
        <input id="allocNasdaq" type="number" value="60" min="0" max="100" />
      </div>
      
      <div class="control-group">
        <label>货币基金 年化收益率（%）</label>
        <input id="cashYield" type="number" value="2" step="0.01" />
      </div>
      
      <div class="control-group">
        <label><input id="rebalance" type="checkbox" checked /> 每年再平衡到初始比例</label>
      </div>

      <fieldset class="withdraw">
        <legend>年度提取策略</legend>
        <div class="withdraw-option">
          <label><input name="wdMode" type="radio" value="none" checked /> 不提取</label>
        </div>
        <div class="withdraw-option">
          <label><input name="wdMode" type="radio" value="fixed" /> 固定金额（¥）</label>
          <input id="wdFixed" type="number" value="0" />
        </div>
        <div class="withdraw-option">
          <label><input name="wdMode" type="radio" value="percent" /> 百分比（%）</label>
          <input id="wdPct" type="number" value="0" step="0.1" />
        </div>
      </fieldset>

      <div class="control-group">
        <label>回测时间段</label>
        <div class="date-range">
          <div>
            <label>起始年</label>
            <input id="startYear" type="number" value="1999" />
          </div>
          <span class="dash">~</span>
          <div>
            <label>结束年</label>
            <input id="endYear" type="number" value="2026" />
          </div>
        </div>
      </div>

      <div class="actions">
        <button id="run" class="btn-primary">运行回测</button>
        <button id="download" class="btn-secondary">下载结果 CSV</button>
      </div>
    </section>

    <section class="output">
      <h2>回测结果</h2>
      <div id="metrics" class="metrics-container"></div>
      <canvas id="chart" width="1000" height="400"></canvas>
      <div class="table-wrapper">
        <table id="results">
          <thead>
            <tr>
              <th>年份</th>
              <th>年初总资产(¥)</th>
              <th>应用收益后(¥)</th>
              <th>提取金额(¥)</th>
              <th>提取后(¥)</th>
              <th>再平衡-纳斯达克(¥)</th>
              <th>再平衡-货币基金(¥)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section class="notes">
      <h3>关于此工具</h3>
      <ul>
        <li>使用真实 QQQ（纳斯达克100 ETF）从 1999 年至 2026 年 1 月 28 日的年度回报数据。</li>
        <li>支持自定义时间范围、资产配置、再平衡策略和定期提取方案。</li>
        <li>图表支持鼠标交互：悬停查看具体数值，可拖动缩放或平移。</li>
      </ul>
    </section>
  </div>

  <script src="app.js"></script>
</body>
</html>
